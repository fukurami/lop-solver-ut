PASMO区間大回りソルバ(東大関係特化)
--------

作成者:福町知弘 ([twitter](https://twitter.com/tfukumahi)/[blog](http://fukurami.hatenablog.com))

## 概要

首都圏におけるPASMO導入区間のうち、改札を経由しない（中間改札も）で乗車可能な範囲内での最長経路を探索するjavascript製ソルバです。東京大学のキャンパスがある駒場・本郷の最長経路を探索するために製作したため、直接的に関係しない駅等は省いてあります。

[Github Pages上で利用可能です。](https://fukurami.github.io/lop-solver-ut/)

## 探索の原則

概ね鉄道界隈で主流の大回りルールに則っています。
具体的には、

* 同一駅を二度以上経由しない
* 同一区間を二度以上利用しない
* 経路は一筆書きとなる

を原則とし、PASMO（ICカード全般も含む）の特例として

+ 別事業者の同一名称駅は別個の駅として扱う（内部データが異なるため）

というものがあります。特記事項としては、

- 永田町-赤坂見附のような別名称改札内接続駅については別個のものとして扱う  
（「永田町」と「赤坂見附」をそれぞれ一回ずつ経由する場合はセーフ）

があります。なお、以上の記述は「[東京近郊区間大回り Wiki](http://wikiwiki.jp/omawari/?FrontPage)」を参考にしたものです。

本ソルバでは、いわゆる「6の字」経路や一周経路（O型・P型とも呼ばれる）には対応していません（面倒だったので）。

また、本ソルバでは中間改札を経由する乗換（いわゆる「ラッチ外接続」）は排除しました。例えば飯田橋駅での南北線/有楽町線から東西線への乗換は、中間改札を経由しない経路が無いため考慮しません。（但し、同一事業者の同一名称駅のため南北線飯田橋駅を通った場合東西線飯田橋駅も経由済の扱いになります。）

## 使い方

「発駅」に出発する駅を指定して下さい。「着駅」1～2に到着する駅を2つまで指定して下さい。1つのみ指定する場合は片方を空欄にすると検索が高速化されます。

「JRを含める」をチェックすると、Suica区間（東京近郊区間のみ）を含めた経路を簡易的に計算します。JR区間の最長経路は「[最長大回り経路を計算する](http://nijzero.dw.land.to/document/ldr.html)」に掲載されている計算済みのものをお借りしました。

計算は概ね十数秒～数分程度かかります。利用者のブラウザで実行されるため、計算時間は利用者のマシンスペックに依存します。製作者の環境では平均して1分半～2分程度でした。CPUをかなり使うので注意が必要です。

計算が終わると、結果表示欄に最長経路とその距離が表示されます。「各駅での累計距離を入れる」をチェックすると、始点から経由する各駅までの営業キロが駅ごとに表示されます。

結果表示欄の右側の「Save as txt」リンクを押すことで、表示されている結果をtxt形式でダウンロードできます。

## 計算に使用したデータについて

計算に使用した駅データは「[最長大回り経路を計算する](http://nijzero.dw.land.to/document/ldr.html)」にて配布されているagain@T氏製作のruby製ツール附属のデータを製作者が大幅に改変して作成しました。

計算量削減のため、複数路線が接続していない駅は原則として削除し、また例えば飯田橋-市ヶ谷間のように複数路線（南北線・有楽町線）が同一区間を走っている場合は原則駅間（営業キロ）が最長のもののみを残し削除しています。


## 高度な使い方

結果表示欄下の方の「＊」をクリックすると、計算時の内部データを格納したテキストエリアと、「use slim」チェックボックスが表示されます。後者にチェックすることで、ノード数を減らし最適化したデータを使い計算を行うことができます。但し、通常データにある駅の一部は削除されているため、東大最寄りの駅以外は発・着駅に指定しない方が良いです。また、JRは（「JRを含める」チェックに拘らず）計算に含めません。
